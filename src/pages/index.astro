---
import Layout from '@/layouts/Layout.astro';
import NavBar from '@/components/NavBar.astro';
import Header from '@/components/Header.astro';
import { getCollection } from 'astro:content';
import '@/styles/sneaky.css';

const posts = await getCollection('blog');
const sortedPosts = posts.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<Layout title="Blog - SneakyFoxy" description="Technical writeups, research findings, and CTF solutions by SneakyFoxy">
  <main class="blog-container">
	<NavBar/>
	<Header title="Blog" 
			subtitle="Technical writeups, research findings, and interesting problems I encounter."/>

    <div class="posts-list">
      {sortedPosts.map(post => (
        <div class="post-item">
          <h2 class="post-title">
            <a href={`/${post.id}/`}>{post.data.title}</a>
          </h2>
          
          <div class="post-meta">
            <time datetime={post.data.date.toISOString()}>
              {post.data.date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              })}
            </time>
            {post.data.tags && (
              <div class="tags-classic">
                {post.data.tags.map(tag => (
                  <span class="tag">{tag}</span>
                ))}
              </div>
            )}
          </div>
          
          {post.data.description && (
            <p class="post-excerpt">{post.data.description}</p>
          )}
        </div>
      ))}
    </div>

    {sortedPosts.length === 0 && (
      <div class="empty-state">
        <p>No posts yet, but some interesting writeups are coming soon...</p>
      </div>
    )}
  </main>
</Layout>